# Поиск пиков

***Задание с 2 на 5 (сложно)***

У вас есть некоторый сигнал, полученный по результатом измерений чего-то некоторого объекта (это неважно). Данные записаны в файл sample.dat (первый столбец -- значение по оси X, второй -- значение по оси Y). Сигнал очень зашумлён. На глаз сигнальные пики определить невозможно. Предварительно необходимо данные отфильтровать и льшб после этого можно будет определить пики. 
Учтите, что в данных есть некоторая подложка. Для её определения при проведения эксперимента был записана область, в которой гарантированно нет сигнала.

* Точка является пиком, если она является локальным максимумом (Правая, forward, и левая, backward, [конечные разности](https://en.wikipedia.org/wiki/Finite_difference) разных знаков).
* Пики различимы, если значение в минимуме между ними меньше k% (варьируемая величина, далее valley_max_val) от значение наименьшего из двух пиков.

Работайте в предположении [гауссовой](https://ru.wikipedia.org/wiki/Гауссова_функция) формы пика, то есть [фурье от него тоже будет гауссом](https://ru.wikipedia.org/wiki/Преобразование_Фурье#Важные_формулы).

## **Задачи:**

1) При помощи средств языка Python и всех доступных в нём библиотек:
   1) Построить график сигнал (амплитуда со спектрометра против частоты),
   2) Определить уровень подложки (далее threshold)
   3) Провести спектральную фильтрацию для устранения высоких частот
   4) Провести сглажиывание сигнала при помощи [простого скользящего среднего](https://ru.wikipedia.org/wiki/Скользящая_средняя#Простое_скользящее_среднее)
2) При помощи средств языка C++ написать функцию, которая возвращает вектор пар всех найденных пиков.
3) В C++ записать полученные координаты пиков в файл.
4) В python считать файл и построить график отфильтрованного сигнала, в котором красными точками указаны пики

У C++ функции должен быть следующая сигнатура. Функция должна быть в отдельном хедере.

```cpp
std::vector<std::pair<double, double>> FindPeaks(std::vector<double> xs, std::vector<double> ys, double valley_max_val, double threshold);
```

Бог вам в помощь!
